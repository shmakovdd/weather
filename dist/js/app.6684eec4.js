(function(){"use strict";var t={9902:function(t,e,a){var r=a(9242),i=a(3396);const n={class:"app"};function s(t,e,a,r,s,o){const c=(0,i.up)("app-header"),d=(0,i.up)("favorite-briefly"),u=(0,i.up)("router-view");return(0,i.wg)(),(0,i.iD)("div",n,[(0,i.Wm)(c),(0,i.Wm)(d),(0,i.Wm)(u)])}const o={class:"header"};function c(t,e,a,r,n,s){const c=(0,i.up)("app-logo"),d=(0,i.up)("app-nav-bar"),u=(0,i.up)("app-container");return(0,i.wg)(),(0,i.iD)("div",o,[(0,i.Wm)(u,{class:"header__container"},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{onClick:e[0]||(e[0]=t=>this.$router.push("/"))}),(0,i.Wm)(d)])),_:1})])}var d=a(6949);const u=t=>((0,i.dD)("data-v-3975ab4f"),t=t(),(0,i.Cn)(),t),l={class:"logo"},p=u((()=>(0,i._)("div",{class:"logo__wrapper"},[(0,i._)("img",{class:"logo__img",src:d,alt:"logo"})],-1))),h=u((()=>(0,i._)("div",{class:"logo__text"},[(0,i._)("h3",null,"AccuVueWeather")],-1))),m=[p,h];function _(t,e,a,r,n,s){return(0,i.wg)(),(0,i.iD)("div",l,m)}var v={},y=a(89);const f=(0,y.Z)(v,[["render",_],["__scopeId","data-v-3975ab4f"]]);var g=f;const w={class:"container"};function C(t,e,a,r,n,s){return(0,i.wg)(),(0,i.iD)("div",w,[(0,i.WI)(t.$slots,"default",{},void 0,!0)])}var D={};const I=(0,y.Z)(D,[["render",C],["__scopeId","data-v-7a6d9db0"]]);var k=I,b=a(7139);const A={class:"navbar"},F=(0,i.Uk)("Список городов"),W={key:1,class:"navbar__favorite__wrapper"},L=(0,i.Uk)(" Избранное "),$=(0,i.Uk)("Войти"),B=(0,i.Uk)("Регистрация"),T=(0,i.Uk)("Выйти");function O(t,e,a,r,n,s){const o=(0,i.up)("app-button"),c=(0,i.up)("app-favorite-hidden");return(0,i.wg)(),(0,i.iD)("div",A,[t.isAuth?((0,i.wg)(),(0,i.j4)(o,{key:0,class:"navbar__btn",onClick:e[0]||(e[0]=t=>this.$router.push("/cities"))},{default:(0,i.w5)((()=>[F])),_:1})):(0,i.kq)("",!0),t.isAuth?((0,i.wg)(),(0,i.iD)("div",W,[(0,i.Wm)(o,{onClick:s.toggleFavActive,class:"navbar__btn"},{default:(0,i.w5)((()=>[L])),_:1},8,["onClick"]),(0,i.Wm)(c,{class:(0,b.C_)([{active:n.isFavActive},"navbar__favorite"])},null,8,["class"])])):(0,i.kq)("",!0),t.isAuth?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(o,{key:2,onClick:e[1]||(e[1]=t=>this.$router.push("/login")),class:"navbar__btn"},{default:(0,i.w5)((()=>[$])),_:1})),t.isAuth?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(o,{key:3,onClick:e[2]||(e[2]=t=>this.$router.push("/reg")),class:"navbar__btn"},{default:(0,i.w5)((()=>[B])),_:1})),t.isAuth?((0,i.wg)(),(0,i.j4)(o,{key:4,onClick:s.logOut,class:"navbar__btn"},{default:(0,i.w5)((()=>[T])),_:1},8,["onClick"])):(0,i.kq)("",!0)])}const z={class:"favorite-hidden"},S={key:0,class:"favorite-hidden__list"},x={key:1,class:"favorite-hidden__plug"};function j(t,e,a,r,n,s){const o=(0,i.up)("favorite-item");return(0,i.wg)(),(0,i.iD)("div",z,[t.favoriteList.length>=1?((0,i.wg)(),(0,i.iD)("ul",S,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.favoriteList,(t=>((0,i.wg)(),(0,i.j4)(o,{key:t.id,city:t,class:"favorite-hidden__item"},null,8,["city"])))),128))])):((0,i.wg)(),(0,i.iD)("div",x,"Нет городов в избранном."))])}var U=a(65);const E={class:"favorite-item"},Z=["data-id","data-api_id"],V=["data-id"];function q(t,e,a,r,n,s){return(0,i.wg)(),(0,i.iD)("li",E,[(0,i._)("div",{onClick:e[0]||(e[0]=(...t)=>s.findCityByID&&s.findCityByID(...t)),"data-id":a.city.id,"data-api_id":a.city.api_city_id,class:"favorite-hidden__city-name"},(0,b.zw)(a.city.name),9,Z),(0,i._)("span",{onClick:e[1]||(e[1]=(...e)=>t.deleteCity&&t.deleteCity(...e)),"data-id":a.city.id,class:"favorite-hidden__delete"},"Удалить",8,V)])}var M={props:{city:{type:Object,required:!0}},methods:{...(0,U.OI)({setCityID:"current/setCityID"}),...(0,U.nv)({deleteCity:"favorite/deleteCity",getCurrentWeatherById:"current/getCurrentWeatherById"}),findCityByID(t){this.getCurrentWeatherById(t.target.dataset.api_id),this.$router.push("/"),this.setCityID(t.target.dataset.id)}}};const Q=(0,y.Z)(M,[["render",q],["__scopeId","data-v-0c581756"]]);var H=Q,P={components:{FavoriteItem:H},computed:{...(0,U.rn)({favoriteList:t=>t.favorite.favoriteList})}};const G=(0,y.Z)(P,[["render",j],["__scopeId","data-v-4b890dd0"]]);var R=G;const K={class:"btn"};function N(t,e,a,r,n,s){return(0,i.wg)(),(0,i.iD)("button",K,[(0,i.WI)(t.$slots,"default")])}var Y={};const J=(0,y.Z)(Y,[["render",N]]);var X=J,tt=a(6265),et=a.n(tt);function at(t){let e=t.getMinutes(),a=t.getUTCHours();return e=1==e.toString().length?"0"+e:e,a=1==a.toString().length?"0"+a:a,{minutes:e,hours:a}}function rt(t){return t.charAt(0).toUpperCase()+t.slice(1)}function it(t){let e={23:"C",45:"СВ",68:"СВ",90:"В",113:"В",135:"ЮВ",158:"ЮВ",180:"Ю",203:"Ю",225:"ЮЗ",248:"ЮЗ",270:"З",293:"З",315:"СЗ",338:"СЗ",360:"С"},a=Object.keys(e),r=a.find((e=>t<e));return e[r]}function nt(t,e,a={}){a={path:"/",...a},a.expires instanceof Date&&(a.expires=a.expires.toUTCString());let r=encodeURIComponent(t)+"="+encodeURIComponent(e);for(let i in a){r+="; "+i;let t=a[i];!0!==t&&(r+="="+t)}document.cookie=r}function st(t){let e=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0}function ot(t){let e=new Date(1e3*t.dt),a=["ВС","ПН","ВТ","СР","ЧТ","ПТ","СБ"],r={id:Date.now(),weekDay:a[e.getDay()],day:e.getDate(),temp:`${Math.trunc(t.temp.day)}°C`,clouds:`${t.clouds}%`,icon:`https://openweathermap.org/img/wn/${t.weather[0].icon}@2x.png`,descr:rt(t.weather[0].description)};return r}function ct(t){nt(t,"",{"max-age":-1})}var dt={data(){return{isFavActive:!1}},computed:{...(0,U.rn)({isAuth:t=>t.isAuth})},components:{AppButton:X,AppFavoriteHidden:R},methods:{...(0,U.OI)({setAuth:"setAuth"}),toggleFavActive(){this.isFavActive=!this.isFavActive},logOut(){et()({method:"POST",headers:{Authorization:`Bearer ${st("authToken")}`},url:"https://front-test.academy.smartworld.team/api/api/logout"}).then((t=>{!0===t.data.success&&ct("authToken")})),this.setAuth(!1),this.$router.push("/login")}}};const ut=(0,y.Z)(dt,[["render",O],["__scopeId","data-v-2b53b0f6"]]);var lt=ut,pt={components:{AppLogo:g,AppContainer:k,AppNavBar:lt}};const ht=(0,y.Z)(pt,[["render",c],["__scopeId","data-v-a6da5716"]]);var mt=ht;const _t={key:0,class:"favorite-brief"},vt={class:"favorite-brief__list"},yt=["data-api_id","data-id"],ft={class:"favorite-brief__city-name"},gt={class:"favorite-brief__city-info"},wt={class:"favorite-brief__icon-wrapper"},Ct=["src"],Dt={class:"favorite-brief__weather"};function It(t,e,a,r,n,s){const o=(0,i.up)("app-container");return t.isAuth?((0,i.wg)(),(0,i.iD)("div",_t,[(0,i.Wm)(o,{class:"favorite-brief__container"},{default:(0,i.w5)((()=>[(0,i._)("ul",vt,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.favoriteList,(t=>((0,i.wg)(),(0,i.iD)("li",{key:t.id,class:"favorite-brief__item",onClick:e[0]||(e[0]=(...t)=>s.findCityByID&&s.findCityByID(...t)),"data-api_id":t.api_city_id,"data-id":t.id},[(0,i._)("div",ft,(0,b.zw)(t.name),1),(0,i._)("div",gt,[(0,i._)("div",wt,[(0,i._)("img",{src:t.icon,alt:"",class:"favorite-brief__icon"},null,8,Ct)]),(0,i._)("div",Dt,[(0,i._)("span",null,(0,b.zw)(t.temp),1)])])],8,yt)))),128))])])),_:1})])):(0,i.kq)("",!0)}var kt={components:{AppContainer:k},computed:{...(0,U.rn)({favoriteList:t=>t.favorite.favoriteList,isAuth:t=>t.isAuth})},methods:{...(0,U.OI)({setCityID:"current/setCityID"}),...(0,U.nv)({getCurrentWeatherById:"current/getCurrentWeatherById"}),findCityByID(t){this.getCurrentWeatherById(t.currentTarget.dataset.api_id),this.$router.push("/"),this.setCityID(t.currentTarget.dataset.id)}}};const bt=(0,y.Z)(kt,[["render",It],["__scopeId","data-v-3f4eb3aa"]]);var At=bt,Ft={components:{AppHeader:mt,FavoriteBriefly:At},computed:{...(0,U.rn)({isAuth:t=>t.isAuth})},methods:{...(0,U.OI)({setAuth:"setAuth"}),...(0,U.nv)({getFavorites:"favorite/getFavorites",initCentrifuge:"initCentrifuge"}),checkCookie(){st("authToken")&&this.setAuth(!0)}},mounted(){this.checkCookie(),this.isAuth&&(this.getFavorites(),this.initCentrifuge())}};const Wt=(0,y.Z)(Ft,[["render",s]]);var Lt=Wt,$t=a(678);const Bt={class:"city-weather"},Tt={key:1,class:"loading-screen"},Ot=(0,i._)("h1",null,"Идет загрузка...",-1),zt=(0,i.Uk)("Попробовать ещё раз");function St(t,e,a,r,n,s){const o=(0,i.up)("app-current-weather"),c=(0,i.up)("app-daily-weather"),d=(0,i.up)("app-container"),u=(0,i.up)("app-button");return(0,i.wg)(),(0,i.iD)("article",Bt,[t.isDataLoaded?((0,i.wg)(),(0,i.j4)(d,{key:0,class:"city-weather__container"},{default:(0,i.w5)((()=>[(0,i.Wm)(o,{name:t.city,currentData:t.currentCityData,class:"city-weather__crnt-weather"},null,8,["name","currentData"]),(0,i.Wm)(c,{days:t.dailyWeather,class:"city-weather__daily-weather"},null,8,["days"])])),_:1})):((0,i.wg)(),(0,i.iD)("div",Tt,[Ot,t.errorBtn?((0,i.wg)(),(0,i.j4)(u,{key:0,onClick:t.getCurrentLocation,style:{"margin-top":"50px"}},{default:(0,i.w5)((()=>[zt])),_:1},8,["onClick"])):(0,i.kq)("",!0)]))])}const xt=t=>((0,i.dD)("data-v-fa4b8cfa"),t=t(),(0,i.Cn)(),t),jt={class:"current-weather"},Ut=xt((()=>(0,i._)("h1",{class:"current-weather__title"},"Погода Сегодня",-1))),Et={class:"current-weather__wrapper"},Zt={class:"current-weather__city-name"},Vt={class:"current-weather__date"},qt={class:"current-weather__temp"},Mt={class:"current-weather__temp-img-wrapper"},Qt=["src"],Ht={class:"current-weather__temp-info"},Pt={class:"current-weather__other-info"},Gt={class:"current-weather__feels-like"},Rt={class:"current-weather__wind-speed-info"},Kt={class:"current-weather__wind-dir-info"},Nt={class:"current-weather__pressure"},Yt={class:"current-weather__humidity"};function Jt(t,e,a,r,n,s){const o=(0,i.up)("app-favorite-btn"),c=(0,i.up)("app-sun-day");return(0,i.wg)(),(0,i.iD)("div",jt,[Ut,(0,i._)("div",Et,[(0,i._)("div",Zt,(0,b.zw)(a.name),1),(0,i.Wm)(o,{class:"current-weather__favorite"}),(0,i._)("div",Vt,(0,b.zw)(a.currentData.date)+" "+(0,b.zw)(a.currentData.month)+", "+(0,b.zw)(a.currentData.time),1),(0,i._)("div",qt,[(0,i._)("div",Mt,[(0,i._)("img",{class:"current-weather__img",src:a.currentData.icon,alt:"",srcset:""},null,8,Qt)]),(0,i._)("div",Ht,(0,b.zw)(a.currentData.temp),1)]),(0,i._)("div",Pt,[(0,i._)("div",Gt,"Ощущается как "+(0,b.zw)(a.currentData.feels_like)+". "+(0,b.zw)(a.currentData.description),1),(0,i._)("div",Rt,"Скорость ветра: "+(0,b.zw)(a.currentData.windSpeed),1),(0,i._)("div",Kt,"Направление: "+(0,b.zw)(a.currentData.windDir),1),(0,i._)("div",Nt,"Давление: "+(0,b.zw)(a.currentData.pressure),1),(0,i._)("div",Yt,"Влажность: "+(0,b.zw)(a.currentData.humidity),1)]),(0,i.Wm)(c,{sun_day:a.currentData.sun_day},null,8,["sun_day"])])])}const Xt=t=>((0,i.dD)("data-v-42ca2c73"),t=t(),(0,i.Cn)(),t),te={class:"sun-day"},ee=Xt((()=>(0,i._)("div",{class:"sun-day__background"},null,-1))),ae={class:"sun-day__sunrise"},re=Xt((()=>(0,i._)("div",{class:"sun-day__title"},"Восход",-1))),ie={class:"sun-day__value"},ne=Xt((()=>(0,i._)("div",{class:"sun-day__sun"},null,-1))),se={class:"sun-day__sunset"},oe=Xt((()=>(0,i._)("div",{class:"sun-day__title"},"Закат",-1))),ce={class:"sun-day__value"};function de(t,e,a,r,n,s){return(0,i.wg)(),(0,i.iD)("div",te,[ee,(0,i._)("div",ae,[re,(0,i._)("div",ie,(0,b.zw)(a.sun_day?.sunrise),1)]),ne,(0,i._)("div",se,[oe,(0,i._)("div",ce,(0,b.zw)(a.sun_day?.sunset),1)])])}var ue={props:{sun_day:{type:Object}}};const le=(0,y.Z)(ue,[["render",de],["__scopeId","data-v-42ca2c73"]]);var pe=le;const he={key:0,class:"favorite-btn__wrapper"},me={key:0,class:"favorite-btn__btn"},_e={key:1,class:"favorite-btn__plug"},ve=(0,i._)("span",null,"Авторизируйтесь, чтобы добавить в избранное",-1),ye=[ve];function fe(t,e,a,r,n,s){return null!==t.cityID?((0,i.wg)(),(0,i.iD)("div",he,[t.auth?((0,i.wg)(),(0,i.iD)("div",me,[t.getIsInFavorite?((0,i.wg)(),(0,i.iD)("span",{key:1,onClick:e[1]||(e[1]=(...e)=>t.removeFromFav&&t.removeFromFav(...e)),class:"favorite-btn__text"},"Удалить из избранного")):((0,i.wg)(),(0,i.iD)("span",{key:0,onClick:e[0]||(e[0]=(...e)=>t.addToFav&&t.addToFav(...e)),class:"favorite-btn__text"},"Добавить город в избранное"))])):((0,i.wg)(),(0,i.iD)("div",_e,ye))])):(0,i.kq)("",!0)}var ge={computed:{...(0,U.rn)({auth:t=>t.isAuth,cityID:t=>t.current.cityID}),...(0,U.Se)({getIsInFavorite:"favorite/getIsInFavorite"})},methods:{...(0,U.nv)({addToFav:"favorite/addToFav",removeFromFav:"favorite/removeFromFav",checkIfInFav:"favorite/checkIfInFav"})},mounted(){this.checkIfInFav()}};const we=(0,y.Z)(ge,[["render",fe]]);var Ce=we,De={components:{AppSunDay:pe,AppFavoriteBtn:Ce},props:{name:{type:String},currentData:{type:Object,required:!0}}};const Ie=(0,y.Z)(De,[["render",Jt],["__scopeId","data-v-fa4b8cfa"]]);var ke=Ie;const be=t=>((0,i.dD)("data-v-0b1044d5"),t=t(),(0,i.Cn)(),t),Ae={class:"daily-weather"},Fe=be((()=>(0,i._)("h1",{class:"daily-weather__title"}," Погода на неделю ",-1))),We={class:"daily-weather__list"};function Le(t,e,a,r,n,s){const o=(0,i.up)("app-day");return(0,i.wg)(),(0,i.iD)("div",Ae,[Fe,(0,i._)("ul",We,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.days,(t=>((0,i.wg)(),(0,i.j4)(o,{key:t.id,day:t},null,8,["day"])))),128))])])}const $e={class:"day"},Be={class:"day__date"},Te={class:"day__num"},Oe={class:"day__month"},ze={class:"day__temp-img-wrapper"},Se=["src"],xe={class:"day__temp-info"},je={class:"day__descr"},Ue={class:"day__clouds"};function Ee(t,e,a,r,n,s){return(0,i.wg)(),(0,i.iD)("li",$e,[(0,i._)("div",Be,[(0,i._)("div",Te,(0,b.zw)(a.day.day),1),(0,i._)("div",Oe,(0,b.zw)(a.day.weekDay),1)]),(0,i._)("div",ze,[(0,i._)("img",{class:"day__img",src:a.day.icon,alt:"",srcset:""},null,8,Se)]),(0,i._)("div",xe,(0,b.zw)(a.day.temp),1),(0,i._)("div",je,(0,b.zw)(a.day.descr),1),(0,i._)("div",Ue,"Облачность: "+(0,b.zw)(a.day.clouds),1)])}var Ze={props:{day:{type:Object,required:!0}}};const Ve=(0,y.Z)(Ze,[["render",Ee]]);var qe=Ve,Me={components:{AppDay:qe},props:{days:{type:Array,required:!0}}};const Qe=(0,y.Z)(Me,[["render",Le],["__scopeId","data-v-0b1044d5"]]);var He=Qe,Pe={components:{AppContainer:k,AppCurrentWeather:ke,AppDailyWeather:He,AppButton:X},computed:{...(0,U.rn)({isDataLoaded:t=>t.current.isDataLoaded,lon:t=>t.current.lon,lat:t=>t.current.lat,errorBtn:t=>t.current.errorButton,city:t=>t.current.city,currentCityData:t=>t.current.currentCityData,dailyWeather:t=>t.current.dailyWeather})},methods:{...(0,U.OI)({setLon:"current/setLon",setLat:"current/setLat",setCity:"current/setCity",setCurrentCityData:"current/setCurrentCityData",setErrorButton:"current/setErrorButton",setDataLoaded:"current/setDataLoaded"}),...(0,U.nv)({getCurrentWeather:"current/getCurrentWeather",getCurrentLocation:"current/getCurrentLocation"})},mounted(){this.getCurrentLocation()}};const Ge=(0,y.Z)(Pe,[["render",St]]);var Re=Ge;const Ke={class:"cities"},Ne=["model-value"],Ye={class:"cities__list"};function Je(t,e,a,r,n,s){const o=(0,i.up)("city-item"),c=(0,i.up)("app-container");return(0,i.wg)(),(0,i.iD)("div",Ke,[(0,i.Wm)(c,{class:"cities__container"},{default:(0,i.w5)((()=>[(0,i._)("input",{"model-value":t.searchQuery,onInput:e[0]||(e[0]=(...t)=>s.onInput&&s.onInput(...t)),type:"text",class:"cities__search",placeholder:"Поиск...(англ)"},null,40,Ne),(0,i._)("ul",Ye,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.searchedCities,(t=>((0,i.wg)(),(0,i.j4)(o,{key:t.id,city:t},null,8,["city"])))),128))])])),_:1})])}const Xe=["data-id"],ta=["data-id"];function ea(t,e,a,n,s,o){return(0,i.wg)(),(0,i.iD)("li",{class:"city-item",onClick:e[0]||(e[0]=(0,r.iM)(((...t)=>o.findCityByID&&o.findCityByID(...t)),["stop"])),"data-id":a.city.api_city_id},[(0,i._)("span",{class:"city-name","data-id":a.city.api_city_id},(0,b.zw)(o.toUpperCaseCityName),9,ta)],8,Xe)}var aa={props:{city:{type:Object}},computed:{toUpperCaseCityName(){return this.city.name.toUpperCase()}},methods:{...(0,U.nv)({getWeather:"current/getCurrentWeatherById"}),...(0,U.OI)({setCityID:"current/setCityID"}),findCityByID(t){this.getWeather(t.target.dataset.id),this.$router.push("/"),this.setCityID(this.city.id)}}};const ra=(0,y.Z)(aa,[["render",ea],["__scopeId","data-v-123fef5b"]]);var ia=ra,na={components:{AppContainer:k,CityItem:ia},computed:{...(0,U.rn)({citesAtOnce:t=>t.cities.citesAtOnce,cities:t=>t.cities.cities,searchQuery:t=>t.cities.searchQuery}),...(0,U.Se)({searchedCities:"cities/searchedCities"})},methods:{...(0,U.OI)({setSearchQuery:"cities/setSearchQuery"}),onInput(t){let e=t.target.value;this.setSearchQuery(e)},...(0,U.nv)({loadCities:"cities/loadCities"})},mounted(){this.loadCities()}};const sa=(0,y.Z)(na,[["render",Je]]);var oa=sa;const ca=t=>((0,i.dD)("data-v-c2264536"),t=t(),(0,i.Cn)(),t),da={class:"login-form__container"},ua=ca((()=>(0,i._)("h3",{class:"login-form__title"},"Авторизация",-1))),la=(0,i.Uk)("Войти");function pa(t,e,a,n,s,o){const c=(0,i.up)("form-input"),d=(0,i.up)("app-button");return(0,i.wg)(),(0,i.iD)("form",{onSubmit:e[2]||(e[2]=(0,r.iM)((()=>{}),["prevent"])),class:"login-form"},[(0,i._)("div",da,[ua,(0,i.Wm)(c,{modelValue:s.email,"onUpdate:modelValue":e[0]||(e[0]=t=>s.email=t),class:"login-form__input",type:"email",name:"email",placeholder:"Email",required:""},null,8,["modelValue"]),(0,i.Wm)(c,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=t=>s.password=t),class:"login-form__input",type:"password",name:"password",placeholder:"Пароль",required:""},null,8,["modelValue"]),(0,i.Wm)(d,{onClick:o.logIn,class:"login-from__button"},{default:(0,i.w5)((()=>[la])),_:1},8,["onClick"])])],32)}const ha=["value"];function ma(t,e,a,r,n,s){return(0,i.wg)(),(0,i.iD)("input",{value:a.modelValue,onInput:e[0]||(e[0]=(...t)=>s.updateInput&&s.updateInput(...t)),class:"form-input"},null,40,ha)}var _a={props:{modelValue:{type:[String,Number]}},methods:{updateInput(t){this.$emit("update:modelValue",t.target.value)}}};const va=(0,y.Z)(_a,[["render",ma]]);var ya=va,fa={components:{FormInput:ya,AppButton:X},data(){return{email:null,password:null}},methods:{...(0,U.OI)({setAuth:"setAuth"}),...(0,U.nv)({loadCities:"cities/loadCities",getFavorites:"favorite/getFavorites",initCentrifuge:"initCentrifuge"}),logIn(){let t={email:this.email,password:this.password};et()({method:"POST",data:t,url:"https://front-test.academy.smartworld.team/api/api/login",headers:{"Content-Type":"application/json"}}).then((t=>{let{authToken:e,socketToken:a,userId:r}=t.data.data,i=t.data.message;if("Logged"===i){let{token:t,expires_in:i}=e;nt("authToken",t,{"max-age":i}),nt("socketToken",a),nt("userId",r),this.setAuth(!0),this.$router.push("/"),this.loadCities(),this.getFavorites(),this.initCentrifuge()}}))}}};const ga=(0,y.Z)(fa,[["render",pa],["__scopeId","data-v-c2264536"]]);var wa=ga;const Ca=t=>((0,i.dD)("data-v-f4da4a92"),t=t(),(0,i.Cn)(),t),Da={class:"register-form"},Ia={class:"register-form__container"},ka=Ca((()=>(0,i._)("h3",{class:"register-form__title"},"Регистрация",-1))),ba=(0,i.Uk)("Зарегистрироваться");function Aa(t,e,a,r,n,s){const o=(0,i.up)("form-input"),c=(0,i.up)("app-button");return(0,i.wg)(),(0,i.iD)("form",Da,[(0,i._)("div",Ia,[ka,(0,i.Wm)(o,{modelValue:n.login,"onUpdate:modelValue":e[0]||(e[0]=t=>n.login=t),class:"login-form__input",type:"text",name:"name",placeholder:"Имя пользователя"},null,8,["modelValue"]),(0,i.Wm)(o,{modelValue:n.email,"onUpdate:modelValue":e[1]||(e[1]=t=>n.email=t),class:"login-form__input",type:"email",name:"email",placeholder:"Email"},null,8,["modelValue"]),(0,i.Wm)(o,{modelValue:n.password,"onUpdate:modelValue":e[2]||(e[2]=t=>n.password=t),class:"login-form__input",type:"password",name:"password",placeholder:"Пароль"},null,8,["modelValue"]),(0,i.Wm)(o,{class:"login-form__input",type:"password",name:"confirm-password",placeholder:"Подтвердите пароль"}),(0,i.Wm)(c,{class:"login-from__button",onClick:s.postForm},{default:(0,i.w5)((()=>[ba])),_:1},8,["onClick"])])])}var Fa={components:{FormInput:ya,AppButton:X},data(){return{login:null,email:null,password:null}},methods:{postForm(t){t.preventDefault();let e={name:this.login,email:this.email,password:this.password};et()({method:"POST",url:"https://front-test.academy.smartworld.team/api/api/register",data:e,headers:{"Content-Type":"application/json"}}).then((t=>{"Registered"===t.data.message&&(console.log(t.data.message),this.$router.push("/login"))}))}}};const Wa=(0,y.Z)(Fa,[["render",Aa],["__scopeId","data-v-f4da4a92"]]);var La=Wa;const $a=[{path:"/",component:Re},{path:"/cities",component:oa},{path:"/login",component:wa},{path:"/reg",component:La}],Ba=(0,$t.p7)({routes:$a,history:(0,$t.r5)()});var Ta=Ba;let Oa=["ЯНВ","ФЕВ","МАР","АПР","МАЙ","ИЮН","ИЮЛ","АВГ","СЕН","ОКТ","НОЯ","ДЕК"];const za={state:()=>({isDataLoaded:!1,lon:null,lat:null,errorButton:!1,city:"",cityID:null,currentCityData:{},dailyWeather:[]}),mutations:{setLon(t,e){t.lon=(+e).toFixed(6)},setLat(t,e){t.lat=(+e).toFixed(6)},setCity(t,e){t.city=e},setCityID(t,e){t.cityID=e},setCurrentCityData(t,e){t.currentCityData=e},setErrorButton(t,e){t.errorButton=e},setDataLoaded(t,e){t.isDataLoaded=e},setDailyWeather(t,e){t.dailyWeather=e}},actions:{getCurrentLocation(t){let e={enableHighAccuracy:!0,timeout:5e3},a=e=>{1===e.code&&(alert('Пожалуйста, разрешите приложению доступ к вашему местоположению и нажмите "Попробовать ещё раз"'),t.commit("setErrorButton",!0))},r=e=>{t.commit("setErrorButton",!1),null==t.rootState.clientLong&&null==t.rootState.clientLat&&(t.rootState.clientLong=e.coords.longitude,t.rootState.clientLat=e.coords.latitude,t.commit("setLon",e.coords.longitude),t.commit("setLat",e.coords.latitude),t.dispatch("getCurrentWeather"),t.dispatch("getDailyWeather",{})),t.commit("setDataLoaded",!0)};navigator.geolocation.getCurrentPosition(r,a,e)},setCurrentCityData(t,e){let a=new Date(1e3*e.dt+1e3*e.timezone);t.commit("setCity",e.name.toUpperCase());let r=at(a),i=at(new Date(1e3*e.sys.sunrise+1e3*e.timezone)),n=at(new Date(1e3*e.sys.sunset+1e3*e.timezone)),s={month:Oa[a.getMonth()],date:a.getDate(),time:`${r.hours}:${r.minutes}`,temp:`${Math.trunc(e.main.temp)}°C`,windSpeed:`${e.wind.speed} м/с`,windDir:it(e.wind.deg),cloudness:`${e.clouds.all}%`,pressure:.75*e.main.pressure+" мм.рт.ст.",humidity:`${e.main.humidity}%`,feels_like:`${Math.trunc(e.main.feels_like)}°C`,description:rt(e.weather[0].description),icon:`https://openweathermap.org/img/wn/${e.weather[0].icon}@2x.png`,sun_day:{sunrise:`${i.hours}:${i.minutes}`,sunset:`${n.hours}:${n.minutes}`}};t.commit("setCurrentCityData",s)},getDailyWeather({state:t,commit:e},{lon:a,lat:r}){e("setDailyWeather",[]),et()({method:"GET",url:"https://api.openweathermap.org/data/2.5/onecall",params:{lat:r||t.lat,lon:a||t.lon,units:"metric",lang:"ru",exclude:"current,minutely,hourly,alerts",appid:"84bea86b6e84affc971c5ed48003ecea"}}).then((a=>{let r=a.data,i=r.daily.slice(1),n=[];for(let t of i)n.push(ot(t));e("setDailyWeather",[...t.dailyWeather,...n])}))},getCurrentWeather({state:t,dispatch:e,rootState:a}){et()({method:"GET",url:"https://api.openweathermap.org/data/2.5/weather",params:{lat:t.lat,lon:t.lon,units:"metric",lang:"ru",appid:"84bea86b6e84affc971c5ed48003ecea"}}).then((t=>{let r=t.data;a.clientCity=null==a.clientCity?r.name.toUpperCase():a.clientCity,e("setCurrentCityData",r)}))},getCurrentWeatherById({dispatch:t},e){et()({method:"GET",url:"https://api.openweathermap.org/data/2.5/weather",params:{id:e,units:"metric",lang:"ru",appid:"84bea86b6e84affc971c5ed48003ecea"}}).then((e=>{let a=e.data;t("getDailyWeather",{lon:a.coord.lon,lat:a.coord.lat}),t("setCurrentCityData",a)}))}},namespaced:!0},Sa={state:()=>({searchQuery:"",cities:[]}),mutations:{setCities(t,e){t.cities=e},setSearchQuery(t,e){t.searchQuery=e}},getters:{searchedCities(t){return t.cities.filter((e=>e.name.toLowerCase().includes(t.searchQuery.toLowerCase())))||t.cities}},actions:{loadCities({commit:t}){let e=st("authToken");t("setSearchQuery",""),et()({method:"GET",url:"https://front-test.academy.smartworld.team/api/City/get",headers:{Authorization:`Bearer ${e}`}}).then((e=>{t("setCities",e.data.data)}))}},namespaced:!0},xa={state:()=>({isInFavorite:!1,favoriteList:[]}),getters:{getFavoriteList(t){return t.favoriteList},getIsInFavorite(t){return t.isInFavorite}},mutations:{setIsInFavorite(t,e){t.isInFavorite=e},setFavoriteList(t,e){t.favoriteList=e}},actions:{getCitiesWeatherInfo({state:t}){function e(t,e){et()({method:"GET",url:"https://api.openweathermap.org/data/2.5/weather",params:{id:e,units:"metric",lang:"ru",appid:"84bea86b6e84affc971c5ed48003ecea"}}).then((e=>{let a=e.data,r={temp:`${Math.trunc(a.main.temp_min)}°C`,icon:`https://openweathermap.org/img/wn/${a.weather[0].icon}@2x.png`,isLoaded:!0};Object.assign(t,r)}))}t.favoriteList.length&&t.favoriteList.forEach((t=>{t.isLoaded||e(t,t["api_city_id"])}))},getFavorites({commit:t,dispatch:e}){et()({method:"GET",url:"https://front-test.academy.smartworld.team/api/City/getFavourite",headers:{Authorization:`Bearer ${st("authToken")}`}}).then((a=>{let r=a.data;t("setFavoriteList",r.data),e("checkIfInFav"),e("getCitiesWeatherInfo")}))},deleteCity({dispatch:t},e){let a=e.target.dataset.id;et()({method:"DELETE",url:`https://front-test.academy.smartworld.team/api/City/remove/${a}`,headers:{Authorization:`Bearer ${st("authToken")}`}}).then((()=>{t("getFavorites")}))},addToFav({rootState:t,dispatch:e}){let a=t.current.cityID;et()({method:"POST",url:`https://front-test.academy.smartworld.team/api/City/add/${a}`,headers:{Authorization:`Bearer ${st("authToken")}`}}).then((()=>{e("getFavorites")}))},removeFromFav({dispatch:t,rootState:e}){let a=e.current.cityID;et()({method:"DELETE",url:`https://front-test.academy.smartworld.team/api/City/remove/${a}`,headers:{Authorization:`Bearer ${st("authToken")}`}}).then((()=>{t("getFavorites")}))},checkIfInFav({rootState:t,commit:e,getters:a}){let r=a.getFavoriteList,i=r.find((e=>{if(e.id==t.current.cityID)return!0}));e("setIsInFavorite",!!i)}},namespaced:!0};var ja=(0,U.MT)({state:()=>({isAuth:!1,clientLong:null,clientLat:null,clientCity:null}),mutations:{setClientCity(t,e){t.clientCity=e},setAuth(t,e){t.isAuth=e}},actions:{initCentrifuge({rootState:t}){let e=a(818),r=new e("wss://front-test.academy.smartworld.team/connection/websocket");r.setToken(st("socketToken")),r.connect(),r.subscribe(`userChannel#${st("userId")}`,(function(e){t.favorite.favoriteList.forEach((t=>{t.api_city_id===e.data.id&&(t.temp=`${Math.trunc(e.data.main.temp_min-273)}°C`,t.icon=`https://openweathermap.org/img/wn/${e.data.weather[0].icon}@2x.png`,console.log(t))}))}))}},modules:{current:za,cities:Sa,favorite:xa}}),Ua={mounted(t,e){let a={rootMargin:"0px",threshold:1},r=t=>{t[0].isIntersecting&&e.value()},i=new IntersectionObserver(r,a);i.observe(t)}};const Ea=(0,r.ri)(Lt);Ea.directive("intersection",Ua),Ea.use(ja).use(Ta).mount("#app")},6949:function(t,e,a){t.exports=a.p+"img/logo.47e6efb2.png"}},e={};function a(r){var i=e[r];if(void 0!==i)return i.exports;var n=e[r]={exports:{}};return t[r].call(n.exports,n,n.exports,a),n.exports}a.m=t,function(){var t=[];a.O=function(e,r,i,n){if(!r){var s=1/0;for(u=0;u<t.length;u++){r=t[u][0],i=t[u][1],n=t[u][2];for(var o=!0,c=0;c<r.length;c++)(!1&n||s>=n)&&Object.keys(a.O).every((function(t){return a.O[t](r[c])}))?r.splice(c--,1):(o=!1,n<s&&(s=n));if(o){t.splice(u--,1);var d=i();void 0!==d&&(e=d)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[r,i,n]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.p=""}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,r){var i,n,s=r[0],o=r[1],c=r[2],d=0;if(s.some((function(e){return 0!==t[e]}))){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(c)var u=c(a)}for(e&&e(r);d<s.length;d++)n=s[d],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(u)},r=self["webpackChunkfourth_task"]=self["webpackChunkfourth_task"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=a.O(void 0,[998],(function(){return a(9902)}));r=a.O(r)})();
//# sourceMappingURL=app.6684eec4.js.map